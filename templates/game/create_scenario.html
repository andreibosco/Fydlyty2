{% extends "base.html" %}
{% load staticfiles %}
{% block title %}
Create a new scenario
{% endblock %}

{% block content %}
    <div class="row">
        <div class="col-sm-12">
            <h1 class="pageHeading">Create a new scenario</h1>
        </div>
        <div class="clearfix"></div>

        <div class="alert alert-danger" role="alert" style="display: none; margin-left: 15px;">
            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
            <span class="sr-only">Error:</span>
            <span class="error-text"></span>
        </div>

        <form method="POST" action="#" name="ScenarioForm" class="form-horizontal" enctype="multipart/form-data" style="margin-left:20px;">
            {% csrf_token %}

            <div class="col-xs-6">
                <div class="form-group">
                    <label class="col-sm-4 control-label" for="title">Scenario Title *</label>
                    <div class="controls mt7">
                        <input type="text" id="title" name="title" placeholder="Scenario Title">
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-4 control-label" for="bgimage">Background Image</label>
                    <div class="controls mt7">
                        <input type="file" class="uploadimage" id="bgimage" name="bgimage" placeholder="Background Image">
                        <img class="previewImage mt10" id="previewBg" src="#" alt="" />
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-4 control-label" for="name">Character Name</label>
                    <div class="controls mt7">
                        <input type="text" id="name" name="name" placeholder="Character Name">
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-4 control-label" for="role">Character Role</label>
                    <div class="controls mt7">
                        <input type="text" id="role" name="role" placeholder="Character Role">
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-4 control-label" for="gender">Gender</label>
                    <div class="controls mt7">
                        <select id="gender" name="gender">
                            <option value="" disabled="disabled" selected="selected">Gender</option>
                            <option value="M">Male</option>
                            <option value="F">Female</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-4 control-label" for="status">Marital Status</label>
                    <div class="controls mt7">
                        <select id="status" name="status">
                            <option value="" disabled="disabled" selected="selected">Marital Status</option>
                            <option value="N">I don't want to say</option>
                            <option value="S">Single</option>
                            <option value="R">In a relationship</option>
                            <option value="E">Engaged</option>
                            <option value="M">Married</option>
                            <option value="W">Widowed</option>
                            <option value="SP">Separated</option>
                            <option value="D">Divorced</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-4 control-label" for="normalimage">Mood Normal Image *</label>
                    <div class="controls mt7">
                        <input type="file" class="uploadimage" id="normalimage" name="normalimage" placeholder="Mood Normal Image">
                        <img class="previewImage mt10" id="previewN" src="#" alt="" />
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-4 control-label" for="madimage">Mood Mad Image</label>
                    <div class="controls mt7">
                        <input type="file" class="uploadimage" id="madimage" name="madimage" placeholder="Mood Mad Image">
                        <img class="previewImage mt10" id="previewM" src="#" alt="" />
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-4 control-label" for="angryimage">Mood Angry Image</label>
                    <div class="controls mt7">
                        <input type="file" class="uploadimage" id="angryimage" name="angryimage" placeholder="Mood Angry Image">
                        <img class="previewImage mt10" id="previewA" src="#" alt="" />
                    </div>
                </div>
            </div>

            <div class="col-xs-6 divider-right">
                <div class="form-group">
                    <label class="col-sm-4 control-label" for="gameplayer">Game Player *</label>
                    <div class="controls mt7">
                        <input type="text" id="gameplayer" name="gameplayer" placeholder="Game player in script">
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-4 control-label" for="virtualcharacter">Virtual Character *</label>
                    <div class="controls mt7">
                        <input type="text" id="virtualcharacter" name="virtualcharacter" placeholder="Virtual Character in script">
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-4 control-label" for="script">Dialogue Script *</label>
                    <div class="controls mt7">
                        <input type="file" id="script" name="script" placeholder="Dialogue Script">
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-4 control-label" for="context">Context</label>
                    <div class="controls mt7">
                        <textarea id="context" name="context" rows="8" cols="50" placeholder="Describe the context"></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-4 control-label" for="scene">Scene</label>
                    <div class="controls mt7">
                        <textarea id="scene" name="scene" rows="8" cols="50" placeholder="Describe the scene"></textarea>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <div class="col-sm-offset-5 col-sm-10">
                    <button type="submit" class="btn" id="continueBtn" />Submit</button>
                </div>
            </div>
        </form>
    </div>
{% endblock %}

{% block extra_body %}
<script type="text/javascript">
function readURL(input) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();

        reader.onload = function (e) {
            input.nextElementSibling.setAttribute('src', e.target.result);
        }

        reader.readAsDataURL(input.files[0]);
    }
}

$(".uploadimage").change(function(){
    readURL(this);
});
</script>

<script type="text/javascript">
	$('#continueBtn').on('click', function(event){
		var title = $('#title').val();
		var gameplayer = $('#gameplayer').val();
		var virtualcharacter = $('#virtualcharacter').val();
		var normalimage = $('#normalimage').val();
        var madimage = $('#madimage').val();
        var angryimage = $('#angryimage').val();
		var script = $('#script').val();

		var flag = true;

		if (!title || !gameplayer || !virtualcharacter || !script || !normalimage){
		    $('.error-text').html("Required fields cannot be empty.");
		    $('.alert').show();
			flag = false;
		}

		else if (normalimage.split('.')[1] != 'jpg' && normalimage.split('.')[1] != 'png'){
            $('.error-text').html("Only JPEG and PNG type image files allowed.");
            $('.alert').show();
			flag = false;
		}

		else if (script.split('.')[1] != 'csv'){
            $('.error-text').html("Only CSV type dialogue script allowed.");
            $('.alert').show();
			flag = false;
		}

		else if (madimage && (madimage.split('.')[1] != 'jpg' && madimage.split('.')[1] != 'png')){
            $('.error-text').html("Only JPEG and PNG type image files allowed.");
            $('.alert').show();
			flag = false;
		}

		else if (angryimage && (angryimage.split('.')[1] != 'jpg' && angryimage.split('.')[1] != 'png')){
            $('.error-text').html("Only JPEG and PNG type image files allowed.");
            $('.alert').show();
			flag = false;
		}


		return flag;
	});
</script>
{% endblock %}